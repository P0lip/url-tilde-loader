{"version":3,"file":"loader.js","sources":["../src/utils.js","../src/parser.js","../src/loader.js"],"sourcesContent":["\nexport const urlRegex = /(url\\(['\"]?)(~+)([^)]+\\)(?:$|\\s))/g;\n\nexport function replaceTilde(str, replacement) {\n  if (typeof str === 'string' && str.includes('url')) { // a bit cheaper than matching against the entire urlRegex\n    return str.replace(urlRegex, `$1${replacement}$3`);\n  }\n\n  return str;\n}\n","import postcss from 'postcss';\nimport { urlRegex, replaceTilde } from './utils';\n\nexport default (source, { traverse, replacement }) => {\n  const ast = postcss.parse(source);\n\n  if (traverse) {\n    ast.walkDecls((decl) => {\n      const value = replaceTilde(decl.value, replacement);\n      if (value !== decl.value) {\n        const clonedDecl = decl.clone();\n        clonedDecl.value = value;\n        decl.replaceWith(clonedDecl);\n      }\n    });\n  } else {\n    ast.replaceValues(\n      urlRegex,\n      { fast: 'url(' },\n      (str, $1, $2, $3) => `${$1}${replacement}${$3}`,\n    );\n  }\n\n  return ast.toResult();\n};\n","import loaderUtils from 'loader-utils';\nimport transform from './parser';\n\nexport default function (content) {\n  const { traverse, replacement = '~/../' } = loaderUtils.getOptions(this) || {};\n  try {\n    this.callback(null, transform(content, {\n      traverse,\n      replacement,\n    }));\n  } catch (ex) {\n    this.callback(ex, null);\n  }\n}\n"],"names":[],"mappings":";;;;;;;AACO,MAAM,QAAQ,GAAG,oCAAoC,CAAC;;AAE7D,AAAO,SAAS,YAAY,CAAC,GAAG,EAAE,WAAW,EAAE;EAC7C,IAAI,OAAO,GAAG,KAAK,QAAQ,IAAI,GAAG,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE;IAClD,OAAO,GAAG,CAAC,OAAO,CAAC,QAAQ,EAAE,CAAC,EAAE,EAAE,WAAW,CAAC,EAAE,CAAC,CAAC,CAAC;GACpD;;EAED,OAAO,GAAG,CAAC;CACZ;;ACND,gBAAe,CAAC,MAAM,EAAE,EAAE,QAAQ,EAAE,WAAW,EAAE,KAAK;EACpD,MAAM,GAAG,GAAG,OAAO,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;;EAElC,IAAI,QAAQ,EAAE;IACZ,GAAG,CAAC,SAAS,CAAC,CAAC,IAAI,KAAK;MACtB,MAAM,KAAK,GAAG,YAAY,CAAC,IAAI,CAAC,KAAK,EAAE,WAAW,CAAC,CAAC;MACpD,IAAI,KAAK,KAAK,IAAI,CAAC,KAAK,EAAE;QACxB,MAAM,UAAU,GAAG,IAAI,CAAC,KAAK,EAAE,CAAC;QAChC,UAAU,CAAC,KAAK,GAAG,KAAK,CAAC;QACzB,IAAI,CAAC,WAAW,CAAC,UAAU,CAAC,CAAC;OAC9B;KACF,CAAC,CAAC;GACJ,MAAM;IACL,GAAG,CAAC,aAAa;MACf,QAAQ;MACR,EAAE,IAAI,EAAE,MAAM,EAAE;MAChB,CAAC,GAAG,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,KAAK,CAAC,EAAE,EAAE,CAAC,EAAE,WAAW,CAAC,EAAE,EAAE,CAAC,CAAC;KAChD,CAAC;GACH;;EAED,OAAO,GAAG,CAAC,QAAQ,EAAE,CAAC;CACvB,CAAC;;ACrBa,eAAQ,EAAE,OAAO,EAAE;EAChC,MAAM,EAAE,QAAQ,EAAE,WAAW,GAAG,OAAO,EAAE,GAAG,WAAW,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,EAAE,CAAC;EAC/E,IAAI;IACF,IAAI,CAAC,QAAQ,CAAC,IAAI,EAAE,SAAS,CAAC,OAAO,EAAE;MACrC,QAAQ;MACR,WAAW;KACZ,CAAC,CAAC,CAAC;GACL,CAAC,OAAO,EAAE,EAAE;IACX,IAAI,CAAC,QAAQ,CAAC,EAAE,EAAE,IAAI,CAAC,CAAC;GACzB;CACF;;;;"}